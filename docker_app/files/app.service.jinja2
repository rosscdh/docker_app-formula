{%- from "docker_app/map.jinja" import config with context %}
[Unit]
Description={{ config.app.name }}
Wants=network-online.target
After=network-online.target docker.socket firewalld.service
Requires=docker.socket

[Service]
WorkingDirectory={{ config.app.location }}

EnvironmentFile={{ config.app.location }}/.env
ExecStart={{ config.cmd.start }}
ExecStop={{ config.cmd.stop }}

# Let systemd restart this service always
Restart=on-failure
RestartSec=30
StartLimitBurst=3
StartLimitInterval=60s

# Specifies the maximum file descriptor number that can be opened by this process
LimitNOFILE={{ config.limit_nofile }}

# Disable timeout logic and wait until process is stopped
TimeoutStopSec=infinity
SendSIGKILL=no

[Install]
WantedBy=multi-user.target